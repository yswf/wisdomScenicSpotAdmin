webpackJsonp([13],{H63I:function(t,e,a){var n=a("b9b5");"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);a("rjj0")("82ed0396",n,!0,{})},W9fE:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("DcYu"),i={name:"activityInfo",data:function(){return{currentPage:1,buyData:[],datePicker:""}},mounted:function(){this.getBuyData()},methods:{timestampToTime:function(t){var e=new Date(t);return e.getFullYear()+"-"+((e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1)+"-")+(e.getDate()<10?"0"+e.getDate():e.getDate())},getBuyData:function(){var t=this;this.buyData=[],Object(n.c)({selectPlayDate:this.timestampToTime(this.datePicker)},"get").then(function(e){if(0!=e.length){for(var a=1,n={},i=0;i<e.length;i++)n={num:a++,id:e[i].id,number:e[i].number,price:e[i].ticketPay,ticketId:e[i].ticketId,title:[],desc:[]},t.buyData.push(n);t.getTicketDetail()}else t.$message.success(e.msg)}).catch(function(e){console.log(22),t.$message.success("获取失败")})},getTicketDetail:function(){var t=this;this.buyData.forEach(function(e,a){Object(n.h)({ticketId:e.ticketId},"get").then(function(e){console.log(111),t.buyData[a].title=e[0].title,t.buyData[a].desc=e[0].descs,console.log(t.buyData[a])}).catch(function(e){console.log(222),t.$message.success("获取电子门票信息失败")})})},goSearch:function(){this.getBuyData()},handleEdit:function(t,e){this.$router.push({path:"/home/activityInfo/edit",query:{id:e.id,title:e.title,desc:e.desc}})},handleDelete:function(t,e){var a=this;console.log(t,e),deleteActivity({id:e.id},"post").then(function(t){a.$message.success(t.msg)}).catch(function(t){console.log(22),a.$message.success("删除失败")}),this.getBuyData()},handleCurrentChange:function(t){console.log("当前页: "+t),this.getBuyData(t)},handleSizeChange:function(t){console.log("每页 "+t+" 条")}}},l={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"activityInfo"},[a("div",{staticClass:"header"},[a("el-date-picker",{attrs:{type:"date",size:"small",placeholder:"选择日期"},model:{value:t.datePicker,callback:function(e){t.datePicker=e},expression:"datePicker"}}),t._v(" "),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.goSearch}},[t._v("查询")]),t._v(" "),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){return t.$router.push("/home/bookTicket/edit")}}},[t._v("添加门票套餐")])],1),t._v(" "),a("el-table",{attrs:{data:t.buyData,stripe:"",size:"small","default-sort":{prop:"date",order:"descending"},"cell-style":{padding:"1px 0"},"header-cell-style":{background:"#ddd"}}},[a("el-table-column",{attrs:{prop:"num",label:"序号",sortable:"",width:"80"}}),t._v(" "),a("el-table-column",{attrs:{prop:"id",label:"ID",sortable:"",width:"180"}}),t._v(" "),a("el-table-column",{attrs:{prop:"title",label:"门票名称",width:"200"}}),t._v(" "),a("el-table-column",{attrs:{label:"门票描述",width:"250"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-popover",{staticClass:"activity-info",attrs:{trigger:"hover",placement:"top"}},[a("p",[t._v("门票描述:")]),t._v(" "),a("p",[t._v(t._s(e.row.desc))]),t._v(" "),a("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[a("el-tag",{attrs:{size:"medium"}},[t._v(t._s(e.row.desc))])],1)])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"number",label:"游玩人数",width:"80"}}),t._v(" "),a("el-table-column",{attrs:{prop:"price",label:"购票价格",width:"120"}}),t._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{size:"mini"},on:{click:function(a){return t.handleEdit(e.$index,e.row)}}},[t._v("编辑")]),t._v(" "),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return t.handleDelete(e.$index,e.row)}}},[t._v("删除")])]}}])})],1),t._v(" "),a("el-pagination",{staticClass:"pagination",attrs:{background:"","current-page":t.currentPage,"page-size":10,layout:"total, prev, pager, next, jumper",total:t.buyData.length},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)},staticRenderFns:[]};var o=a("VU/8")(i,l,!1,function(t){a("H63I")},null,null);e.default=o.exports},b9b5:function(t,e,a){(t.exports=a("FZ+f")(!1)).push([t.i,".header{margin-bottom:10px}.header .el-input{width:200px}.header .el-button--small{float:right}.activity-info .el-tag--medium{width:200px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;vertical-align:middle;margin:4px 0}.el-popover{width:400px}.pagination{float:right;margin-top:10px}",""])}});
//# sourceMappingURL=13.7915c4ae1a22808ea20b.js.map